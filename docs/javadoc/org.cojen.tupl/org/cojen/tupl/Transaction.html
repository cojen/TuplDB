<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (20) -->
<title>Transaction (Tupl 1.8.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: module: org.cojen.tupl, package: org.cojen.tupl, interface: Transaction">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Transaction.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../../module-summary.html">org.cojen.tupl</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.cojen.tupl</a></div>
<h1 title="Interface Transaction" class="title">Interface Transaction</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/Flushable.html" title="class or interface in java.io" class="external-link">Flushable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">Transaction</span><span class="extends-implements">
extends <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/Flushable.html" title="class or interface in java.io" class="external-link">Flushable</a></span></div>
<div class="block">Defines a logical unit of work. Transaction instances can only be safely
 used by one thread at a time, and they must be <a href="#reset()"><code>reset</code></a> when no
 longer needed. Instances can be exchanged by threads, as long as a
 happens-before relationship is established. Without proper exclusion,
 multiple threads interacting with a Transaction instance may cause database
 corruption.

 <p>Transactions also contain various methods for directly controlling locks,
 although their use is not required. Methods which operate upon transactions
 acquire and release locks automatically. Direct control over locks is
 provided for advanced use cases. One such use is record filtering:

 
<div class="snippet-container"><button class="copy snippet-copy" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy"></button>
<pre class="snippet"><code class="language-java">Transaction txn = ...
Cursor c = index.newCursor(txn);
for (LockResult result = c.first(); c.key() != null; result = c.next()) {
    if (shouldDiscard(c.value()) &amp;&amp; result == LockResult.ACQUIRED) {
        // Unlock record which doesn't belong in the transaction.
        txn.unlock();
        continue;
    }
    ...
}
</code></pre>
</div>


 <p>Note: Transaction instances are never fully closed after they are reset
 or have fully exited. Any operation which acts upon a reset transaction can
 resurrect it.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="Database.html#newTransaction()"><code>Database.newTransaction</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final <a href="Transaction.html" title="interface in org.cojen.tupl">Transaction</a></code></div>
<div class="col-second even-row-color"><code><a href="#BOGUS" class="member-name-link">BOGUS</a></code></div>
<div class="col-last even-row-color">
<div class="block">Transaction instance which isn't a transaction at all.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab5" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab5', 3)" class="table-tab">Default Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#attach(java.lang.Object)" class="member-name-link">attach</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Attach an arbitrary object to this transaction instance, for tracking it.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#attach(org.cojen.tupl.CommitCallback)" class="member-name-link">attach</a><wbr>(<a href="CommitCallback.html" title="interface in org.cojen.tupl">CommitCallback</a>&nbsp;callback)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Attach a commit callback to this transaction instance, in place of an ordinary
 attachment.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#attachment()" class="member-name-link">attachment</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Returns any attachment which was set earlier.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#check()" class="member-name-link">check</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Checks the validity of the transaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#commit()" class="member-name-link">commit</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Commits all modifications made within the current transaction scope.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#commitAll()" class="member-name-link">commitAll</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Commits and exits all transaction scopes.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="DurabilityMode.html" title="enum class in org.cojen.tupl">DurabilityMode</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#durabilityMode()" class="member-name-link">durabilityMode</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the durability mode of this transaction.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#durabilityMode(org.cojen.tupl.DurabilityMode)" class="member-name-link">durabilityMode</a><wbr>(<a href="DurabilityMode.html" title="enum class in org.cojen.tupl">DurabilityMode</a>&nbsp;mode)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sets the durability mode for the entire transaction, not just the current scope.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#enter()" class="member-name-link">enter</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Enters a nested transaction scope, which begins with the <a href="LockMode.html#UPGRADABLE_READ"><code>UPGRADABLE_READ</code></a> lock mode.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#exit()" class="member-name-link">exit</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Exits the current transaction scope, rolling back all uncommitted
 modifications made within.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#flush()" class="member-name-link">flush</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Manually flush all buffered changes made by this transaction to the shared redo
 log.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default long</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#id()" class="member-name-link">id</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Returns the currently assigned identifier for this transaction, which is zero when the
 transaction cannot replicate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#isBogus()" class="member-name-link">isBogus</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#isNested()" class="member-name-link">isNested</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns true if the current transaction scope is nested.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lastLockedIndex()" class="member-name-link">lastLockedIndex</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the index id of the last lock acquired, within the current scope.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lastLockedKey()" class="member-name-link">lastLockedKey</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the key of the last lock acquired, within the current scope.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockCheck(long,byte%5B%5D)" class="member-name-link">lockCheck</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Checks the lock ownership for the given key.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockExclusive(long,byte%5B%5D)" class="member-name-link">lockExclusive</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any additional
 locks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockExclusive(long,byte%5B%5D,long)" class="member-name-link">lockExclusive</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any additional
 locks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockMode.html" title="enum class in org.cojen.tupl">LockMode</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockMode()" class="member-name-link">lockMode</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the current lock mode.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockMode(org.cojen.tupl.LockMode)" class="member-name-link">lockMode</a><wbr>(<a href="LockMode.html" title="enum class in org.cojen.tupl">LockMode</a>&nbsp;mode)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sets the lock mode for the current scope.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockShared(long,byte%5B%5D)" class="member-name-link">lockShared</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockShared(long,byte%5B%5D,long)" class="member-name-link">lockShared</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockTimeout(long,java.util.concurrent.TimeUnit)" class="member-name-link">lockTimeout</a><wbr>(long&nbsp;timeout,
 <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/TimeUnit.html" title="class or interface in java.util.concurrent" class="external-link">TimeUnit</a>&nbsp;unit)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sets the lock timeout for the current scope.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>long</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockTimeout(java.util.concurrent.TimeUnit)" class="member-name-link">lockTimeout</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/TimeUnit.html" title="class or interface in java.util.concurrent" class="external-link">TimeUnit</a>&nbsp;unit)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the current lock timeout, in the given unit.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockUpgradable(long,byte%5B%5D)" class="member-name-link">lockUpgradable</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#lockUpgradable(long,byte%5B%5D,long)" class="member-name-link">lockUpgradable</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#nestingLevel()" class="member-name-link">nestingLevel</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Counts the current transaction scope nesting level.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#reset()" class="member-name-link">reset</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Exits all transaction scopes, rolling back all uncommitted modifications.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#reset(java.lang.Throwable)" class="member-name-link">reset</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;cause)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Reset the transaction due to the given cause.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#tryLockExclusive(long,byte%5B%5D,long)" class="member-name-link">tryLockExclusive</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#tryLockShared(long,byte%5B%5D,long)" class="member-name-link">tryLockShared</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#tryLockUpgradable(long,byte%5B%5D,long)" class="member-name-link">tryLockUpgradable</a><wbr>(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#unlock()" class="member-name-link">unlock</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Fully releases the last lock or group acquired, within the current scope.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#unlockCombine()" class="member-name-link">unlockCombine</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Combines the last lock acquired or upgraded into a group which can be unlocked together.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#unlockToShared()" class="member-name-link">unlockToShared</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Releases the last lock or group acquired, within the current scope, retaining a shared
 lock.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="BOGUS">
<h3>BOGUS</h3>
<div class="member-signature"><span class="modifiers">static final</span>&nbsp;<span class="return-type"><a href="Transaction.html" title="interface in org.cojen.tupl">Transaction</a></span>&nbsp;<span class="element-name">BOGUS</span></div>
<div class="block">Transaction instance which isn't a transaction at all. It always operates in an
 <a href="LockMode.html#UNSAFE">unsafe</a> lock mode and a <a href="DurabilityMode.html#NO_REDO">no-redo</a> durability mode. For safe auto-commit transactions, pass null for the
 transaction argument.</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="lockMode(org.cojen.tupl.LockMode)">
<h3>lockMode</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">lockMode</span><wbr><span class="parameters">(<a href="LockMode.html" title="enum class in org.cojen.tupl">LockMode</a>&nbsp;mode)</span></div>
<div class="block">Sets the lock mode for the current scope. Transactions begin in <a href="LockMode.html#UPGRADABLE_READ"><code>UPGRADABLE_READ</code></a> mode, as do newly entered scopes. Exiting a
 scope reverts the lock mode.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>mode</code> - new lock mode</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if mode is null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockMode()">
<h3>lockMode</h3>
<div class="member-signature"><span class="return-type"><a href="LockMode.html" title="enum class in org.cojen.tupl">LockMode</a></span>&nbsp;<span class="element-name">lockMode</span>()</div>
<div class="block">Returns the current lock mode.</div>
</section>
</li>
<li>
<section class="detail" id="lockTimeout(long,java.util.concurrent.TimeUnit)">
<h3>lockTimeout</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">lockTimeout</span><wbr><span class="parameters">(long&nbsp;timeout,
 <a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/TimeUnit.html" title="class or interface in java.util.concurrent" class="external-link">TimeUnit</a>&nbsp;unit)</span></div>
<div class="block">Sets the lock timeout for the current scope. A negative timeout is
 infinite.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>unit</code> - required unit if timeout is more than zero</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockTimeout(java.util.concurrent.TimeUnit)">
<h3>lockTimeout</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name">lockTimeout</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/util/concurrent/TimeUnit.html" title="class or interface in java.util.concurrent" class="external-link">TimeUnit</a>&nbsp;unit)</span></div>
<div class="block">Returns the current lock timeout, in the given unit.</div>
</section>
</li>
<li>
<section class="detail" id="durabilityMode(org.cojen.tupl.DurabilityMode)">
<h3>durabilityMode</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">durabilityMode</span><wbr><span class="parameters">(<a href="DurabilityMode.html" title="enum class in org.cojen.tupl">DurabilityMode</a>&nbsp;mode)</span></div>
<div class="block">Sets the durability mode for the entire transaction, not just the current scope. The
 durability mode primarily affects commit behavior at the top-level scope, but it can also
 be used to switch redo logging behavior.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>mode</code> - new durability mode</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if mode is null</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="durabilityMode()">
<h3>durabilityMode</h3>
<div class="member-signature"><span class="return-type"><a href="DurabilityMode.html" title="enum class in org.cojen.tupl">DurabilityMode</a></span>&nbsp;<span class="element-name">durabilityMode</span>()</div>
<div class="block">Returns the durability mode of this transaction.</div>
</section>
</li>
<li>
<section class="detail" id="check()">
<h3>check</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">check</span>()
    throws <span class="exceptions"><a href="DatabaseException.html" title="class in org.cojen.tupl">DatabaseException</a></span></div>
<div class="block">Checks the validity of the transaction.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="InvalidTransactionException.html" title="class in org.cojen.tupl">InvalidTransactionException</a></code> - if transaction is broken or was invalidated by
 an earlier exception</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if transaction is bogus</dd>
<dd><code><a href="DatabaseException.html" title="class in org.cojen.tupl">DatabaseException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isBogus()">
<h3>isBogus</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">isBogus</span>()</div>
</section>
</li>
<li>
<section class="detail" id="commit()">
<h3>commit</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">commit</span>()
     throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Commits all modifications made within the current transaction scope. The
 current scope is still valid after this method is called, unless an
 exception is thrown. Call exit or reset to fully release transaction
 resources.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="CommitCallback.html" title="interface in org.cojen.tupl"><code>CommitCallback</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="commitAll()">
<h3>commitAll</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">commitAll</span>()
        throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Commits and exits all transaction scopes.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="CommitCallback.html" title="interface in org.cojen.tupl"><code>CommitCallback</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="enter()">
<h3>enter</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">enter</span>()
    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Enters a nested transaction scope, which begins with the <a href="LockMode.html#UPGRADABLE_READ"><code>UPGRADABLE_READ</code></a> lock mode.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#lockMode(org.cojen.tupl.LockMode)"><code>lockMode</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="exit()">
<h3>exit</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">exit</span>()
   throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Exits the current transaction scope, rolling back all uncommitted
 modifications made within. The transaction is still valid after this
 method is called, unless an exception is thrown.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="reset()">
<h3>reset</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">reset</span>()
    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Exits all transaction scopes, rolling back all uncommitted modifications. Equivalent to:

 
<div class="snippet-container"><button class="copy snippet-copy" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy"></button>
<pre class="snippet"><code class="language-java">while (txn.isNested()) {
    txn.exit();
}
txn.exit();
</code></pre>
</div>
</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="reset(java.lang.Throwable)">
<h3>reset</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">reset</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;cause)</span></div>
<div class="block">Reset the transaction due to the given cause. This provides an opportunity to prevent
 this transaction from being used any further. No exception is thrown when invoking this
 method.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>cause</code> - pass a cause to reset and disable the transaction; pass null to simply
 reset the transaction and ignore any exception when doing so</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockShared(long,byte[])">
<h3>lockShared</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockShared</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key)</span>
               throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks. If return
 value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong
 enough lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted or timed out</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockUpgradable(long,byte[])">
<h3>lockUpgradable</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockUpgradable</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key)</span>
                   throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong enough lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockExclusive(long,byte[])">
<h3>lockExclusive</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockExclusive</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key)</span>
                  throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any additional
 locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction
 already owns exclusive lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="isNested()">
<h3>isNested</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">isNested</span>()</div>
<div class="block">Returns true if the current transaction scope is nested.</div>
</section>
</li>
<li>
<section class="detail" id="nestingLevel()">
<h3>nestingLevel</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">nestingLevel</span>()</div>
<div class="block">Counts the current transaction scope nesting level. Count is zero if non-nested.</div>
</section>
</li>
<li>
<section class="detail" id="tryLockShared(long,byte[],long)">
<h3>tryLockShared</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">tryLockShared</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
                  throws <span class="exceptions"><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a>,
<a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks. If return
 value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong
 enough lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout,
 unless the timeout is zero</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockShared(long,byte[],long)">
<h3>lockShared</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockShared</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
               throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire a shared lock for the given key, denying exclusive locks. If return
 value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong
 enough lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if too many shared locks</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted or timed out</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="tryLockUpgradable(long,byte[],long)">
<h3>tryLockUpgradable</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">tryLockUpgradable</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
                      throws <span class="exceptions"><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a>,
<a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong enough lock, and no extra unlock should be
 performed. If <a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a> is returned, transaction holds a shared
 lock, which cannot be upgraded.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a>, <a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout,
 unless the timeout is zero</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockUpgradable(long,byte[],long)">
<h3>lockUpgradable</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockUpgradable</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
                   throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an upgradable lock for the given key, denying exclusive and
 additional upgradable locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns a strong enough lock, and no extra unlock should be
 performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="tryLockExclusive(long,byte[],long)">
<h3>tryLockExclusive</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">tryLockExclusive</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
                     throws <span class="exceptions"><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a>,
<a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any
 additional locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction already owns exclusive lock, and no extra unlock
 should be performed. If <a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a> is returned,
 transaction holds a shared lock, which cannot be upgraded.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ILLEGAL"><code>ILLEGAL</code></a>, <a href="LockResult.html#INTERRUPTED"><code>INTERRUPTED</code></a>, <a href="LockResult.html#TIMED_OUT_LOCK"><code>TIMED_OUT_LOCK</code></a>, <a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout,
 unless the timeout is zero</dd>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockExclusive(long,byte[],long)">
<h3>lockExclusive</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockExclusive</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key,
 long&nbsp;nanosTimeout)</span>
                  throws <span class="exceptions"><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></span></div>
<div class="block">Attempts to acquire an exclusive lock for the given key, denying any additional
 locks. If return value is <a href="LockResult.html#isAlreadyOwned()">owned</a>, transaction
 already owns exclusive lock, and no extra unlock should be performed.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - non-null key to lock; instance is not cloned and so it must not be modified
 after calling this method</dd>
<dd><code>nanosTimeout</code> - maximum time to wait for lock; negative timeout is infinite</dd>
<dt>Returns:</dt>
<dd><a href="LockResult.html#ACQUIRED"><code>ACQUIRED</code></a>, <a href="LockResult.html#UPGRADED"><code>UPGRADED</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
<dt>Throws:</dt>
<dd><code><a href="LockFailureException.html" title="class in org.cojen.tupl">LockFailureException</a></code> - if interrupted, timed out, or illegal upgrade</dd>
<dd><code><a href="DeadlockException.html" title="class in org.cojen.tupl">DeadlockException</a></code> - if deadlock was detected after waiting the full timeout</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lockCheck(long,byte[])">
<h3>lockCheck</h3>
<div class="member-signature"><span class="return-type"><a href="LockResult.html" title="enum class in org.cojen.tupl">LockResult</a></span>&nbsp;<span class="element-name">lockCheck</span><wbr><span class="parameters">(long&nbsp;indexId,
 byte[]&nbsp;key)</span></div>
<div class="block">Checks the lock ownership for the given key.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Returns:</dt>
<dd><a href="LockResult.html#UNOWNED"><code>UNOWNED</code></a>, <a href="LockResult.html#OWNED_SHARED"><code>OWNED_SHARED</code></a>, <a href="LockResult.html#OWNED_UPGRADABLE"><code>OWNED_UPGRADABLE</code></a>, or <a href="LockResult.html#OWNED_EXCLUSIVE"><code>OWNED_EXCLUSIVE</code></a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lastLockedIndex()">
<h3>lastLockedIndex</h3>
<div class="member-signature"><span class="return-type">long</span>&nbsp;<span class="element-name">lastLockedIndex</span>()</div>
<div class="block">Returns the index id of the last lock acquired, within the current scope.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>locked index id, 0 if no locks are held</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="lastLockedKey()">
<h3>lastLockedKey</h3>
<div class="member-signature"><span class="return-type">byte[]</span>&nbsp;<span class="element-name">lastLockedKey</span>()</div>
<div class="block">Returns the key of the last lock acquired, within the current scope.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>locked key (not cloned), or null if no locks are held</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="unlock()">
<h3>unlock</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">unlock</span>()</div>
<div class="block">Fully releases the last lock or group acquired, within the current scope. If the last
 lock operation was an upgrade, for a lock not immediately acquired, unlock is not
 allowed. Instead, an IllegalStateException is thrown.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if no locks are held, or if unlocking an exclusive lock, or if
 crossing a scope boundary, or if unlocking a non-immediate upgrade</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="unlockToShared()">
<h3>unlockToShared</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">unlockToShared</span>()</div>
<div class="block">Releases the last lock or group acquired, within the current scope, retaining a shared
 lock. If the last lock operation was an upgrade, for a lock not immediately acquired,
 unlock is not allowed. Instead, an IllegalStateException is thrown.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if no locks are held, or if unlocking an exclusive lock, or if
 crossing a scope boundary, or if too many shared locks, or if unlocking a non-immediate
 upgrade</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="unlockCombine()">
<h3>unlockCombine</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">unlockCombine</span>()</div>
<div class="block">Combines the last lock acquired or upgraded into a group which can be unlocked together.

 <p><i>Note: This method is intended for advanced use cases.</i></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if combining an acquire with an upgrade</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="id()">
<h3>id</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">long</span>&nbsp;<span class="element-name">id</span>()</div>
<div class="block">Returns the currently assigned identifier for this transaction, which is zero when the
 transaction cannot replicate. After the transaction has finished, a new identifier is
 generated when requested again.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>a positive transaction identifier, or zero if transaction cannot replicate</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="attach(java.lang.Object)">
<h3>attach</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">attach</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;obj)</span></div>
<div class="block">Attach an arbitrary object to this transaction instance, for tracking it. Attachments
 can become visible to other threads as a result of a <a href="LockTimeoutException.html" title="class in org.cojen.tupl"><code>LockTimeoutException</code></a>. A
 happens-before relationship is guaranteed only if the attachment is set before the
 associated lock is acquired. Also, the LockTimeoutException constructor calls toString
 on the attachment, and includes it in the message. A non-default toString implementation
 must consider thread-safety.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>obj</code> - the object to be attached; may be null</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code> - if completely unsupported by the transaction
 implementation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="attach(org.cojen.tupl.CommitCallback)">
<h3>attach</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">attach</span><wbr><span class="parameters">(<a href="CommitCallback.html" title="interface in org.cojen.tupl">CommitCallback</a>&nbsp;callback)</span></div>
<div class="block">Attach a commit callback to this transaction instance, in place of an ordinary
 attachment. It behaves like an ordinary attachment, but it also receives special
 attention by pending transactions.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/UnsupportedOperationException.html" title="class or interface in java.lang" class="external-link">UnsupportedOperationException</a></code> - if completely unsupported by the transaction
 implementation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="attachment()">
<h3>attachment</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span>&nbsp;<span class="element-name">attachment</span>()</div>
<div class="block">Returns any attachment which was set earlier.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the current attachment, or null if none</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="flush()">
<h3>flush</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">flush</span>()
    throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Manually flush all buffered changes made by this transaction to the shared redo
 log. Flushing is performed automatically when the buffer fills up, or when the
 transaction is committed. Flushing can be used in conjunction with replication, to
 ensure that locks and changes are visible to replicas before the transaction commits.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/Flushable.html#flush()" title="class or interface in java.io" class="external-link">flush</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/Flushable.html" title="class or interface in java.io" class="external-link">Flushable</a></code></dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/20/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2011&#x2013;2023 <a href="https://github.com/cojen">Cojen</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
